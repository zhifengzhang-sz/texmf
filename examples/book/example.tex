\documentclass[11pt,dark=4508]{QIBook}
%\documentclass[11pt,light=4502]{QIBook}
%--------------------------------------------------------------------------------------------------
% title page style
%--------------------------------------------------------------------------------------------------
%\usepackage[quil={bg=black,fg=white}]{QITitlePage}
% \usepackage[hexagon={primary,white,secondary2,1993}]{QITitlePage}
% \usepackage[martinhelso={tb=bw,bg=images/a4/bw_130x297_2}]{QITitlePage}
\usepackage[martinhelso={title box=bw,background image=images/a4/color_210x297_1.png}]{QITitlePage}
%--------------------------------------------------------------------------------------------------
% loading lipsum, table, enumitem and pgfplots
%--------------------------------------------------------------------------------------------------
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{lipsum}
\usepackage{tabularx,colortbl}
\usepackage{enumitem}
\usepackage{pgfplots}
\usepackage{multicol}
\usepackage{filecontents}
%--------------------------------------------------------------------------------------------------
% configuring pgfplots
%--------------------------------------------------------------------------------------------------
\pgfplotsset{compat = newest}
\usetikzlibrary{positioning, arrows.meta}
\usepgfplotslibrary{fillbetween}
%--------------------------------------------------------------------------------------------------
% loading the pre-defined tkz graph
%--------------------------------------------------------------------------------------------------
\input{../tkz/arbelos.tex}
\input{../tkz/notations.tex}
\input{../tkz/midpoints.tex}
\input{../tkz/goldenrationseg.tex}
%--------------------------------------------------------------------------------------------------
% loading the pre-defined pgfplots graph
%--------------------------------------------------------------------------------------------------

\makeatletter
\newcommand{\lighter}[2]{
    \color{\color@lighter{#1}{#2}}
}
\newcommand{\darken}[2]{
    \color{\color@darken{#1}{#2}}
}
\makeatother
\def\theendseperator{\pardecoration[\decocolor][closing][\vfill]}
\begin{document}
\titlehead{Topics in Typesetting}
\subject{Latex Styling}
\title{A Demo for the QIBook Class}
\subtitle{}
\author{Zhifeng Zhang}
\date{2023}
\publishers{Tian Yi Publishing}
\makeatletter
\qi@titlepage
\makeatother
\frontmatter
\tableofcontents
\mainmatter
\pagestyle{headings}
\chapter{Color Palette}
\lipsum[6]
\section{Using palette as foreground color}
\lipsum[7]
\setCodeTheme{basic}{font}{\sffamily\tiny}
{\tiny
    \input{colorfgfull.tex}
}
\lipsum[8]
\section{Using palette as background color}
\lipsum[7]
\begin{wrapfigure}{r}*
    \tiny
    \input{colorbg.tex}
\end{wrapfigure}
\lipsum[8-12]
\section{Defining color model}
\subsection{Direct definitions}
\lipsum[7]
\begin{wrapfigure}{l}*
    \tiny
    \input{colorfg.tex}
\end{wrapfigure}
\lipsum[8-10]
\subsection{Using API}
\lipsum[7]
\begin{wrapfigure}{r}*
    \tiny
    \input{colorfg.tex}
\end{wrapfigure}
\lipsum[8-12]
\section{Setting text colors}
\lipsum[7]
{\tiny
    \input{colorbgfull.tex}
}
\lipsum[8-12]
\section{Tint and shade}
\subsection{Tint}
\begin{itemize}
    \item {\lighter{primary}{25}primary lighter by 25}
    \item {\lighter{primary}{50}primary lighter by 50}
    \item {\lighter{primary}{75}primary lighter by 75}
\end{itemize}

\subsection{Shade}
\begin{itemize}
    \item {\darken{primary}{25}primary darken by 25}
    \item {\darken{primary}{50}primary darken by 50}
    \item {\darken{primary}{75}primary darken by 75}
\end{itemize}
\setchapterpreamble[ul][.375\linewidth]{%
    \vskip -4em
    \dictum[Lewis Carroll]{%
        Begin at the beginning, and go on till you come to the end: then stop.}
    \vskip 3em
}
\chapter{Decorative Elements}
\section{Epigraph}
\lipsum[1-4]
\section{Lettrine}
\lettrine{L}{orem ipsum}\ \lipsum[5-8]
\section{Chapter decoration}
\lipsum[9-10]
\pardecoration[\decocolor][dinkus]
\lipsum[11-15]
\pardecoration
\lipsum[16-19]
\theendseperator
\chapter{Structural Elements}
\section{Page colors defined in pgfkeys}
\lipsum[20]
\begin{wrapfigure}{r}*
    \footnotesize
    \input{pagecolor.tex}
\end{wrapfigure}
\lipsum[21-27]

\chapter{Textual Tools}
\section{Multi-columns}
\subsection{Source code list}
\lipsum[20-22]
\begin{multicols}{2}
    \lstset{numbers=left,
        numberstyle=\tiny,
        numbersep=5pt,
        numberfirstline=true,
        firstnumber=1}%, stepnumber=5}
    \lstset{xleftmargin=2em}
    \lstset{morecomment=[is]{\%/*}{*/}}
    \tiny
    \tcbcodefile[listing only]{../../tex/latex/QICommon.sty}{QICommon.sty}
\end{multicols}
\lipsum[23-25]
\subsection{Text}
\lipsum[1]
\begin{multicols}{3}
    \lipsum[1-10]
\end{multicols}
\lipsum[2-5]
\section{Wrapping text around a block element}
\subsection{wrapfigure}
\subsection{wraptable}
\subsection{wraptext}

\chapter{Theorem Type of Elements}

\chapter{Block Elements}
\section{Tables}
\section{Figures}

\chapter{Box Elements}
\section{Code List}
\section{Tables}
\section{Lists}
\section{Remark}
\section{Note}
\section{Figures}
\section{Examples}
\end{document}